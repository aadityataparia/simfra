{"version":3,"file":"sifrr.server.module.js","sources":["../src/server/utils.js","../src/server/mime.js","../src/server/sendfile.js","../src/server/formdata.js","../src/server/loadroutes.js","../src/server/baseapp.js","../src/server/app.js","../src/server/sslapp.js","../src/sifrr.server.js"],"sourcesContent":["function writeHeaders(res, headers, other) {\n  if (typeof other !== 'undefined') {\n    res.writeHeader(headers, other.toString());\n  } else {\n    for (let n in headers) {\n      res.writeHeader(n, headers[n].toString());\n    }\n  }\n}\n\nfunction clone(obj) {\n  if (typeof obj === 'object') {\n    if (Array.isArray(obj)) return obj.slice(0);\n    if (obj === null) return null;\n    return Object.assign({}, obj);\n  } else {\n    return obj;\n  }\n}\n\nfunction extend(who, from, overwrite = true) {\n  const ownProps = Object.getOwnPropertyNames(from.prototype);\n  ownProps.forEach(prop => {\n    if (prop === 'constructor') return;\n    if (who[prop] && overwrite) {\n      who[`_${prop}`] = who[prop];\n    }\n    if (typeof from.prototype[prop] === 'function') who[prop] = from.prototype[prop].bind(who);\n    else who[prop] = clone(from.prototype[prop]);\n  });\n}\n\nfunction stob(stream) {\n  return new Promise(resolve => {\n    const buffers = [];\n    stream.on('data', buffers.push.bind(buffers));\n\n    stream.on('end', () => {\n      switch (buffers.length) {\n        case 0:\n          resolve(Buffer.allocUnsafe(0));\n          break;\n        case 1:\n          resolve(buffers[0]);\n          break;\n        default:\n          resolve(Buffer.concat(buffers));\n      }\n    });\n  });\n}\n\nmodule.exports = {\n  writeHeaders,\n  extend,\n  stob\n};\n","const mimes = {\n  '3gp': 'video/3gpp',\n  a: 'application/octet-stream',\n  ai: 'application/postscript',\n  aif: 'audio/x-aiff',\n  aiff: 'audio/x-aiff',\n  asc: 'application/pgp-signature',\n  asf: 'video/x-ms-asf',\n  asm: 'text/x-asm',\n  asx: 'video/x-ms-asf',\n  atom: 'application/atom+xml',\n  au: 'audio/basic',\n  avi: 'video/x-msvideo',\n  bat: 'application/x-msdownload',\n  bin: 'application/octet-stream',\n  bmp: 'image/bmp',\n  bz2: 'application/x-bzip2',\n  c: 'text/x-c',\n  cab: 'application/vnd.ms-cab-compressed',\n  cc: 'text/x-c',\n  chm: 'application/vnd.ms-htmlhelp',\n  class: 'application/octet-stream',\n  com: 'application/x-msdownload',\n  conf: 'text/plain',\n  cpp: 'text/x-c',\n  crt: 'application/x-x509-ca-cert',\n  css: 'text/css',\n  csv: 'text/csv',\n  cxx: 'text/x-c',\n  deb: 'application/x-debian-package',\n  der: 'application/x-x509-ca-cert',\n  diff: 'text/x-diff',\n  djv: 'image/vnd.djvu',\n  djvu: 'image/vnd.djvu',\n  dll: 'application/x-msdownload',\n  dmg: 'application/octet-stream',\n  doc: 'application/msword',\n  dot: 'application/msword',\n  dtd: 'application/xml-dtd',\n  dvi: 'application/x-dvi',\n  ear: 'application/java-archive',\n  eml: 'message/rfc822',\n  eps: 'application/postscript',\n  exe: 'application/x-msdownload',\n  f: 'text/x-fortran',\n  f77: 'text/x-fortran',\n  f90: 'text/x-fortran',\n  flv: 'video/x-flv',\n  for: 'text/x-fortran',\n  gem: 'application/octet-stream',\n  gemspec: 'text/x-script.ruby',\n  gif: 'image/gif',\n  gz: 'application/x-gzip',\n  h: 'text/x-c',\n  hh: 'text/x-c',\n  htm: 'text/html',\n  html: 'text/html',\n  ico: 'image/vnd.microsoft.icon',\n  ics: 'text/calendar',\n  ifb: 'text/calendar',\n  iso: 'application/octet-stream',\n  jar: 'application/java-archive',\n  java: 'text/x-java-source',\n  jnlp: 'application/x-java-jnlp-file',\n  jpeg: 'image/jpeg',\n  jpg: 'image/jpeg',\n  js: 'application/javascript',\n  json: 'application/json',\n  log: 'text/plain',\n  m3u: 'audio/x-mpegurl',\n  m4v: 'video/mp4',\n  man: 'text/troff',\n  mathml: 'application/mathml+xml',\n  mbox: 'application/mbox',\n  mdoc: 'text/troff',\n  me: 'text/troff',\n  mid: 'audio/midi',\n  midi: 'audio/midi',\n  mime: 'message/rfc822',\n  mjs: 'application/javascript',\n  mml: 'application/mathml+xml',\n  mng: 'video/x-mng',\n  mov: 'video/quicktime',\n  mp3: 'audio/mpeg',\n  mp4: 'video/mp4',\n  mp4v: 'video/mp4',\n  mpeg: 'video/mpeg',\n  mpg: 'video/mpeg',\n  ms: 'text/troff',\n  msi: 'application/x-msdownload',\n  odp: 'application/vnd.oasis.opendocument.presentation',\n  ods: 'application/vnd.oasis.opendocument.spreadsheet',\n  odt: 'application/vnd.oasis.opendocument.text',\n  ogg: 'application/ogg',\n  p: 'text/x-pascal',\n  pas: 'text/x-pascal',\n  pbm: 'image/x-portable-bitmap',\n  pdf: 'application/pdf',\n  pem: 'application/x-x509-ca-cert',\n  pgm: 'image/x-portable-graymap',\n  pgp: 'application/pgp-encrypted',\n  pkg: 'application/octet-stream',\n  pl: 'text/x-script.perl',\n  pm: 'text/x-script.perl-module',\n  png: 'image/png',\n  pnm: 'image/x-portable-anymap',\n  ppm: 'image/x-portable-pixmap',\n  pps: 'application/vnd.ms-powerpoint',\n  ppt: 'application/vnd.ms-powerpoint',\n  ps: 'application/postscript',\n  psd: 'image/vnd.adobe.photoshop',\n  py: 'text/x-script.python',\n  qt: 'video/quicktime',\n  ra: 'audio/x-pn-realaudio',\n  rake: 'text/x-script.ruby',\n  ram: 'audio/x-pn-realaudio',\n  rar: 'application/x-rar-compressed',\n  rb: 'text/x-script.ruby',\n  rdf: 'application/rdf+xml',\n  roff: 'text/troff',\n  rpm: 'application/x-redhat-package-manager',\n  rss: 'application/rss+xml',\n  rtf: 'application/rtf',\n  ru: 'text/x-script.ruby',\n  s: 'text/x-asm',\n  sgm: 'text/sgml',\n  sgml: 'text/sgml',\n  sh: 'application/x-sh',\n  sig: 'application/pgp-signature',\n  snd: 'audio/basic',\n  so: 'application/octet-stream',\n  svg: 'image/svg+xml',\n  svgz: 'image/svg+xml',\n  swf: 'application/x-shockwave-flash',\n  t: 'text/troff',\n  tar: 'application/x-tar',\n  tbz: 'application/x-bzip-compressed-tar',\n  tcl: 'application/x-tcl',\n  tex: 'application/x-tex',\n  texi: 'application/x-texinfo',\n  texinfo: 'application/x-texinfo',\n  text: 'text/plain',\n  tif: 'image/tiff',\n  tiff: 'image/tiff',\n  torrent: 'application/x-bittorrent',\n  tr: 'text/troff',\n  txt: 'text/plain',\n  vcf: 'text/x-vcard',\n  vcs: 'text/x-vcalendar',\n  vrml: 'model/vrml',\n  war: 'application/java-archive',\n  wav: 'audio/x-wav',\n  wma: 'audio/x-ms-wma',\n  wmv: 'video/x-ms-wmv',\n  wmx: 'video/x-ms-wmx',\n  wrl: 'model/vrml',\n  wsdl: 'application/wsdl+xml',\n  xbm: 'image/x-xbitmap',\n  xhtml: 'application/xhtml+xml',\n  xls: 'application/vnd.ms-excel',\n  xml: 'application/xml',\n  xpm: 'image/x-xpixmap',\n  xsl: 'application/xml',\n  xslt: 'application/xslt+xml',\n  yaml: 'text/yaml',\n  yml: 'text/yaml',\n  zip: 'application/zip',\n  default: 'text/html'\n};\n\nmodule.exports = {\n  getMime: path => {\n    const i = path.lastIndexOf('.');\n    return mimes[path.substr(i + 1).toLowerCase()] || mimes['default'];\n  },\n  mimes\n};\n","const fs = require('fs');\nconst zlib = require('zlib');\n\nconst compressions = {\n  br: zlib.createBrotliCompress,\n  gzip: zlib.createGzip,\n  deflate: zlib.createDeflate\n};\nconst { writeHeaders } = require('./utils');\nconst getMime = require('./mime').getMime;\nconst bytes = 'bytes=';\nconst { stob } = require('./utils');\n\nfunction sendFile(res, req, path, options) {\n  sendFileToRes(\n    res,\n    {\n      'if-modified-since': req.getHeader('if-modified-since'),\n      range: req.getHeader('range'),\n      'accept-encoding': req.getHeader('accept-encoding')\n    },\n    path,\n    options\n  );\n}\n\nfunction sendFileToRes(\n  res,\n  reqHeaders,\n  path,\n  {\n    lastModified = true,\n    headers,\n    compress = false,\n    compressionOptions = {\n      priority: ['gzip', 'br', 'deflate']\n    },\n    cache = false\n  } = {}\n) {\n  let { mtime, size } = fs.statSync(path);\n  mtime.setMilliseconds(0);\n  const mtimeutc = mtime.toUTCString();\n\n  headers = Object.assign({}, headers);\n  // handling last modified\n  if (lastModified) {\n    // Return 304 if last-modified\n    if (reqHeaders['if-modified-since']) {\n      if (new Date(reqHeaders['if-modified-since']) >= mtime) {\n        res.writeStatus('304 Not Modified');\n        return res.end();\n      }\n    }\n    headers['last-modified'] = mtimeutc;\n  }\n  headers['content-type'] = getMime(path);\n\n  // write data\n  let start = 0,\n    end = size - 1;\n\n  if (reqHeaders.range) {\n    compress = false;\n    const parts = reqHeaders.range.replace(bytes, '').split('-');\n    start = parseInt(parts[0], 10);\n    end = parts[1] ? parseInt(parts[1], 10) : end;\n    headers['accept-ranges'] = 'bytes';\n    headers['content-range'] = `bytes ${start}-${end}/${size}`;\n    size = end - start + 1;\n    res.writeStatus('206 Partial Content');\n  }\n\n  // for size = 0\n  if (end < 0) end = 0;\n\n  let readStream = fs.createReadStream(path, { start, end });\n  // Compression;\n  let compressed = false;\n  if (compress) {\n    const l = compressionOptions.priority.length;\n    for (let i = 0; i < l; i++) {\n      const type = compressionOptions.priority[i];\n      if (reqHeaders['accept-encoding'].indexOf(type) > -1) {\n        compressed = type;\n        const compressor = compressions[type](compressionOptions);\n        readStream.pipe(compressor);\n        readStream = compressor;\n        headers['content-encoding'] = compressionOptions.priority[i];\n        break;\n      }\n    }\n  }\n\n  res.onAborted(() => readStream.destroy());\n  writeHeaders(res, headers);\n  // check cache\n  if (cache) {\n    return cache.wrap(\n      `${path}_${mtimeutc}_${start}_${end}_${compressed}`,\n      cb => {\n        stob(readStream)\n          .then(b => cb(null, b))\n          .catch(cb);\n      },\n      { ttl: 0 },\n      (err, buffer) => {\n        if (err) {\n          res.writeStatus('500 Internal server error');\n          res.end();\n          throw err;\n        }\n        res.end(buffer);\n      }\n    );\n  } else if (compressed) {\n    readStream.on('data', buffer => {\n      res.write(buffer.buffer.slice(buffer.byteOffset, buffer.byteOffset + buffer.byteLength));\n    });\n  } else {\n    readStream.on('data', buffer => {\n      const chunk = buffer.buffer.slice(buffer.byteOffset, buffer.byteOffset + buffer.byteLength),\n        lastOffset = res.getWriteOffset();\n\n      // First try\n      const [ok, done] = res.tryEnd(chunk, size);\n\n      if (done) {\n        readStream.destroy();\n      } else if (!ok) {\n        // pause because backpressure\n        readStream.pause();\n\n        // Save unsent chunk for later\n        res.ab = chunk;\n        res.abOffset = lastOffset;\n\n        // Register async handlers for drainage\n        res.onWritable(offset => {\n          const [ok, done] = res.tryEnd(res.ab.slice(offset - res.abOffset), size);\n          if (done) {\n            readStream.destroy();\n          } else if (ok) {\n            readStream.resume();\n          }\n          return ok;\n        });\n      }\n    });\n  }\n  readStream\n    .on('error', () => {\n      res.writeStatus('500 Internal server error');\n      res.end();\n      readStream.destroy();\n    })\n    .on('end', () => {\n      res.end();\n    });\n}\n\nmodule.exports = sendFile;\n","const fs = require('fs');\nconst path = require('path');\nconst Busboy = require('busboy');\nconst mkdirp = require('mkdirp');\n\nfunction formData(contType, options = {}) {\n  options.headers = {\n    'content-type': contType\n  };\n\n  return new Promise((resolve, reject) => {\n    const busb = new Busboy(options);\n    const ret = {};\n\n    this.bodyStream().pipe(busb);\n\n    busb.on('limit', () => {\n      if (options.abortOnLimit) {\n        reject(Error('limit'));\n      }\n    });\n\n    busb.on('file', function(fieldname, file, filename, encoding, mimetype) {\n      const value = {\n        filename,\n        encoding,\n        mimetype\n      };\n\n      if (typeof options.tmpDir === 'string') {\n        if (typeof options.filename === 'function') filename = options.filename(filename);\n        const fileToSave = path.join(options.tmpDir, filename);\n        mkdirp(path.dirname(fileToSave));\n\n        file.pipe(fs.createWriteStream(fileToSave));\n        value.filePath = fileToSave;\n      } else options.onFile(fieldname, file, filename, encoding, mimetype);\n\n      setRetValue(ret, fieldname, value);\n    });\n\n    busb.on('field', function(fieldname, value) {\n      if (typeof options.onField === 'function') options.onField(fieldname, value);\n\n      setRetValue(ret, fieldname, value);\n    });\n\n    busb.on('finish', function() {\n      resolve(ret);\n    });\n\n    busb.on('error', reject);\n  });\n}\n\nfunction setRetValue(ret, fieldname, value) {\n  if (fieldname.slice(-2) === '[]') {\n    fieldname = fieldname.slice(0, fieldname.length - 2);\n    if (Array.isArray(ret[fieldname])) {\n      ret[fieldname].push(value);\n    } else {\n      ret[fieldname] = [value];\n    }\n  } else {\n    if (Array.isArray(ret[fieldname])) {\n      ret[fieldname].push(value);\n    } else if (ret[fieldname]) {\n      ret[fieldname] = [ret[fieldname], value];\n    } else {\n      ret[fieldname] = value;\n    }\n  }\n}\n\nmodule.exports = formData;\n","const fs = require('fs');\nconst path = require('path');\n\nfunction loadRoutes(dir, { filter = () => true, basePath = '' } = {}) {\n  let files;\n  const paths = [];\n\n  if (fs.statSync(dir).isDirectory()) {\n    files = fs\n      .readdirSync(dir)\n      .filter(filter)\n      .map(file => path.join(dir, file));\n  } else {\n    files = [dir];\n  }\n\n  files.forEach(file => {\n    if (fs.statSync(file).isDirectory()) {\n      // Recursive if directory\n      paths.push(...loadRoutes.call(this, file, { filter, basePath }));\n    } else if (path.extname(file) === '.js') {\n      const routes = require(file);\n      let basePaths = routes.basePath || [''];\n      delete routes.basePath;\n      if (typeof basePaths === 'string') basePaths = [basePaths];\n\n      basePaths.forEach(basep => {\n        for (const method in routes) {\n          const methodRoutes = routes[method];\n          for (let r in methodRoutes) {\n            if (!Array.isArray(methodRoutes[r])) methodRoutes[r] = [methodRoutes[r]];\n            this[method](basePath + basep + r, ...methodRoutes[r]);\n            paths.push(basePath + basep + r);\n          }\n        }\n      });\n    }\n  });\n\n  return paths;\n}\n\nmodule.exports = loadRoutes;\n","const fs = require('fs');\nconst path = require('path');\nconst { Readable } = require('stream');\nconst uWS = require('uWebSockets.js');\nconst chokidar = require('chokidar');\n\nconst sendFile = require('./sendfile');\nconst formData = require('./formdata');\nconst loadroutes = require('./loadroutes');\n\nconst contTypes = ['application/x-www-form-urlencoded', 'multipart/form-data'];\nconst noOp = () => true;\nconst { stob } = require('./utils');\n\nclass BaseApp {\n  file(pattern, path, options = {}) {\n    if (this._staticPaths[pattern]) {\n      if (options.failOnDuplicateRoute)\n        throw Error(\n          `Error serving '${path}' for '${pattern}', already serving '${\n            this._staticPaths[pattern][0]\n          }' file for this patter.`\n        );\n      else if (!options.overwriteRoute) return;\n    }\n\n    this._staticPaths[pattern] = [path, options];\n    this.get(pattern, this._serveStatic);\n    return this;\n  }\n\n  folder(prefix, folder, options, base = folder) {\n    // not a folder\n    if (!fs.statSync(folder).isDirectory()) {\n      throw Error('Given path is not a directory: ' + folder);\n    }\n\n    // ensure slash in beginning and no trailing slash for prefix\n    if (prefix[0] !== '/') prefix = '/' + prefix;\n    if (prefix[prefix.length - 1] === '/') prefix = prefix.slice(0, -1);\n\n    // serve folder\n    const filter = options ? options.filter || noOp : noOp;\n    fs.readdirSync(folder).forEach(file => {\n      // Absolute path\n      const filePath = path.join(folder, file);\n      // Return if filtered\n      if (!filter(filePath)) return;\n\n      if (fs.statSync(filePath).isDirectory()) {\n        // Recursive if directory\n        this.folder(prefix, filePath, options, base);\n      } else {\n        this.file(prefix + '/' + path.relative(base, filePath), filePath, options);\n      }\n    });\n\n    if (options && options.watch) {\n      if (!this._watched[folder]) {\n        const w = chokidar.watch(folder);\n\n        w.on('unlink', filePath => {\n          const url = '/' + path.relative(base, filePath);\n          delete this._staticPaths[prefix + url];\n        });\n\n        w.on('add', filePath => {\n          const url = '/' + path.relative(base, filePath);\n          this.file(prefix + url, filePath, options);\n        });\n\n        this._watched[folder] = w;\n      }\n    }\n    return this;\n  }\n\n  _serveStatic(res, req) {\n    res.onAborted(noOp);\n    const options = this._staticPaths[req.getUrl()];\n    if (typeof options === 'undefined') {\n      res.writeStatus('404 Not Found');\n      res.end();\n    } else sendFile(res, req, options[0], options[1]);\n  }\n\n  post(pattern, handler) {\n    if (typeof handler !== 'function')\n      throw Error(`handler should be a function, given ${typeof handler}.`);\n    this._post(pattern, (res, req) => {\n      const contType = req.getHeader('content-type');\n\n      res.bodyStream = function() {\n        const stream = new Readable();\n        stream._read = noOp;\n\n        this.onData((ab, isLast) => {\n          // uint and then slicing is bit faster than slice and then uint\n          stream.push(new Uint8Array(ab.slice(ab.byteOffset, ab.byteLength)));\n          if (isLast) {\n            stream.push(null);\n          }\n        });\n\n        return stream;\n      };\n\n      res.body = () => stob(res.bodyStream());\n\n      if (contType.indexOf('application/json') > -1)\n        res.json = async () => JSON.parse(await res.body());\n      if (contTypes.map(t => contType.indexOf(t) > -1).indexOf(true) > -1)\n        res.formData = formData.bind(res, contType);\n\n      handler(res, req);\n    });\n    return this;\n  }\n\n  load(dir, options) {\n    loadroutes.call(this, dir, options);\n    return this;\n  }\n\n  listen(h, p = noOp, cb) {\n    if (typeof cb === 'function') {\n      this._listen(h, p, socket => {\n        this._socket = socket;\n        cb(socket);\n      });\n    } else {\n      this._listen(h, socket => {\n        this._socket = socket;\n        p(socket);\n      });\n    }\n    return this;\n  }\n\n  close() {\n    for (let f in this._watched) {\n      this._watched[f].close();\n    }\n    if (this._socket) {\n      uWS.us_listen_socket_close(this._socket);\n      this._socket = null;\n    }\n    return this;\n  }\n}\n\nBaseApp.prototype._staticPaths = {};\nBaseApp.prototype._watched = {};\n\nmodule.exports = BaseApp;\n","const uWS = require('uWebSockets.js');\nconst BaseApp = require('./baseapp');\nconst { extend } = require('./utils');\n\nclass App extends uWS.App {\n  constructor(options = {}) {\n    super(options);\n    extend(this, BaseApp);\n  }\n}\n\nmodule.exports = App;\n","const uWS = require('uWebSockets.js');\nconst BaseApp = require('./baseapp');\nconst { extend } = require('./utils');\n\nclass SSLApp extends uWS.SSLApp {\n  constructor(options) {\n    super(options);\n    extend(this, BaseApp);\n  }\n}\n\nmodule.exports = SSLApp;\n","module.exports = {\n  App: require('./server/app'),\n  SSLApp: require('./server/sslapp'),\n  mimes: require('./server/mime').mimes,\n  getMime: require('./server/mime').getMime,\n  writeHeaders: require('./server/utils').writeHeaders,\n  sendFile: require('./server/sendfile')\n};\n"],"names":["writeHeaders","res","headers","other","writeHeader","toString","n","clone","obj","Array","isArray","slice","Object","assign","extend","who","from","overwrite","ownProps","getOwnPropertyNames","prototype","forEach","prop","bind","stob","stream","Promise","resolve","buffers","on","push","length","Buffer","allocUnsafe","concat","mimes","a","ai","aif","aiff","asc","asf","asm","asx","atom","au","avi","bat","bin","bmp","bz2","c","cab","cc","chm","class","com","conf","cpp","crt","css","csv","cxx","deb","der","diff","djv","djvu","dll","dmg","doc","dot","dtd","dvi","ear","eml","eps","exe","f","f77","f90","flv","for","gem","gemspec","gif","gz","h","hh","htm","html","ico","ics","ifb","iso","jar","java","jnlp","jpeg","jpg","js","json","log","m3u","m4v","man","mathml","mbox","mdoc","me","mid","midi","mime","mjs","mml","mng","mov","mp3","mp4","mp4v","mpeg","mpg","ms","msi","odp","ods","odt","ogg","p","pas","pbm","pdf","pem","pgm","pgp","pkg","pl","pm","png","pnm","ppm","pps","ppt","ps","psd","py","qt","ra","rake","ram","rar","rb","rdf","roff","rpm","rss","rtf","ru","s","sgm","sgml","sh","sig","snd","so","svg","svgz","swf","t","tar","tbz","tcl","tex","texi","texinfo","text","tif","tiff","torrent","tr","txt","vcf","vcs","vrml","war","wav","wma","wmv","wmx","wrl","wsdl","xbm","xhtml","xls","xml","xpm","xsl","xslt","yaml","yml","zip","default","getMime","path","i","lastIndexOf","substr","toLowerCase","compressions","br","zlib","createBrotliCompress","gzip","createGzip","deflate","createDeflate","require$$0","require$$1","bytes","sendFile","req","options","sendFileToRes","getHeader","range","reqHeaders","lastModified","compress","compressionOptions","priority","cache","mtime","size","fs","statSync","setMilliseconds","mtimeutc","toUTCString","Date","writeStatus","end","start","parts","replace","split","parseInt","readStream","createReadStream","compressed","l","type","indexOf","compressor","pipe","onAborted","destroy","wrap","cb","then","b","catch","ttl","err","buffer","write","byteOffset","byteLength","chunk","lastOffset","getWriteOffset","ok","done","tryEnd","pause","ab","abOffset","onWritable","offset","resume","formData","contType","reject","busb","Busboy","ret","bodyStream","abortOnLimit","Error","fieldname","file","filename","encoding","mimetype","value","tmpDir","fileToSave","join","mkdirp","dirname","createWriteStream","filePath","onFile","setRetValue","onField","loadRoutes","dir","filter","basePath","files","paths","isDirectory","readdirSync","map","call","extname","routes","require","basePaths","basep","method","methodRoutes","r","Readable","contTypes","noOp","BaseApp","pattern","_staticPaths","failOnDuplicateRoute","overwriteRoute","get","_serveStatic","folder","prefix","base","relative","watch","_watched","w","chokidar","url","getUrl","post","handler","_post","_read","onData","isLast","Uint8Array","body","JSON","parse","load","loadroutes","listen","_listen","socket","_socket","close","uWS","us_listen_socket_close","App","constructor","SSLApp","require$$2","require$$3","require$$4"],"mappings":"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"}