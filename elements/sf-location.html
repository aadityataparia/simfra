<template>
  <style>

  </style>
  <p>id - #{bind.location.id}</p>
  <p>name - #{bind.location.name}</p>
  <p>address - #{bind.location.address}</p>
  <p>attractions - #{bind.attractions[0].name}</p>
</template>
<script>
  let sfLocation = SFComponent['sf-location'];
  sfLocation.observedAttributes = ['data-location-id', 'data-bind'];
  sfLocation.defaultBind = {
    location: {
      id: 'loading',
      name: 'loading',
      address: 'loading'
    },
    attractions: [{
      name: 'loading'
    }]
  }
  sfLocation.attributeChangedCallback = function(e, attrName, oldVal, newVal) {
    if (attrName == 'data-location-id') {
      SFAPI.get('https://tuneout.aadityataparia.com/api/location/' + newVal, {}, function(result) {
        console.log(newVal, result);
        if (result && result.results) {
          let data = {
            location: result.results.location[0],
            attractions: result.results.attractions
          }
          console.log(data);
          SFComponent.setBindData(e, data);
        }
      });
    }
  }
</script>